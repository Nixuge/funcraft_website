var friendsDiv=$("#player-friends-content"),friendsUrl=friendsDiv.attr("data-url"),friendsDisplayed=!1;$('a[data-toggle="tab"]').on("shown.bs.tab",function(t){if("#player-friends"==$(t.target).attr("href")){if(friendsDisplayed)return;friendsDisplayed=!0,$.ajax(friendsUrl,{cache:!0,success:function(t){friendsDiv.html(t),FunJs.init(friendsDiv)}}).fail(function(t,a){friendsDiv.html("Erreur lors du chargement! (Code : "+t.status+")")})}});var $playerStatsPeriodDropdown=$("#player-stats-period"),$playerStatsPeriodVal=$("#player-stats-period-values").find("a");$playerStatsPeriodVal.click(function(t){var a=$(this),e=a.attr("data-value");setStatsPeriod(e),"always"!=e?window.location.hash=a.attr("data-value"):window.location.hash="",t.preventDefault()}),setStatsPeriod=function(t){var a=null;return $playerStatsPeriodVal.each(function(){if($(this).attr("data-value")==t)return a=$(this),!1}),null!==a&&($playerStatsPeriodDropdown.find("span").first().text(a.first().text()),$(".player-stats-periodval").each(function(){var a=$(this).attr("data-period").split(",");a.indexOf(t)!=-1?$(this).removeClass("hide").show():$(this).hide()}),statschart.setPeriod(t),!0)};var maxHeight=0;$(".player-stats-game").each(function(){var t=Math.ceil($(this)[0].getBoundingClientRect().height);t>maxHeight&&(maxHeight=t)}).css("min-height",maxHeight+"px");var statschart=function(){var t="always",a=function(a){for(var e in pstats[t])for(var i in pstats[t][e].stats){var s=pstats[t][e].stats[i];a(pgames[e],s)}},e=function(a){for(var e in pstatsTotal[t])for(var i in pstatsTotal[t][e].stats){var s=pstatsTotal[t][e].stats[i];a(pgames[e],s)}},i=function(){var t=[];a(function(a,e){"play_time"==e.name&&t.push({name:a.name,y:e.value,color:getGameColor(a.id)})}),0===t.length&&t.push({name:"Vide",color:"#eee",y:1}),$("#player-stats-timechart").highcharts({chart:{plotBackgroundColor:null,plotBorderWidth:null,plotShadow:!0,type:"pie"},title:{text:"RÃ©partition du temps de jeu"},tooltip:{formatter:function(){var t=this.point.y,a=Math.floor(t/60/60)+"h "+Math.floor(t/60%60)+"m";return"<small>"+this.point.name+"</small><br>"+this.series.name+": <b>"+a+" ("+this.point.percentage.toFixed(1)+"%)</b>"}},plotOptions:{pie:{allowPointSelect:!0,cursor:"pointer",dataLabels:{enabled:!1},showInLegend:!0}},series:[{name:"Temps de jeu",colorByPoint:!0,data:t}],credits:!1})},s=function(t){var a={};return t(function(t,e){void 0===a[t.id]&&(a[t.id]={win:0,lost:0}),"games_won"==e.name?a[t.id].win=e.value:"games_lost"==e.name&&(a[t.id].lost=e.value)}),a},r=function(){var t=[],i=[],r=[],n=s(a),o=s(e);for(var l in n){var d=n[l],h=d.win+d.lost;if(h>=3){var p=1*(d.win/h*100).toFixed(1);if(t.push(pgames[l].name),i.push({y:p,color:getGameColor(l)}),o[l]&&(h=o[l].win+o[l].lost,h>0)){var p=1*(o[l].win/h*100).toFixed(1);r.push({y:p,color:getGameColor(l,!0)})}}}$("#player-stats-ratio").highcharts({chart:{type:"column"},title:{text:"Ratio par jeux"},xAxis:{categories:t},yAxis:[{min:0,max:100,title:{text:"Taux de victoire"}}],legend:{enabled:!1},tooltip:{shared:!0,valueSuffix:" %"},plotOptions:{column:{grouping:!1,shadow:!1,borderWidth:0}},series:[{name:"Taux de victoire moyen dans ce jeu",data:r,pointPadding:.05,pointPlacement:0},{name:"Taux de victoire du joueur",data:i,pointPadding:.15,pointPlacement:0}],credits:!1})},n=function(){i(),r()};return{display:n,setPeriod:function(a){t=a,n()}}}();if(statschart.display(),null!==window.location.hash&&""!=window.location.hash&&"#"!=window.location.hash){var hash=window.location.hash;"#"==hash[0]&&(hash=hash.substring(1)),setStatsPeriod(hash)}